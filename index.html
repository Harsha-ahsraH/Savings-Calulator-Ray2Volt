<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Solar Savings Calculator - Ray2Volt Solar</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Google+Sans+Flex:wght@400;500;600;700&family=Nunito+Sans:wght@400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="R2V Shock symbol.png" type="image/png">
</head>

<body>
    <div class="calculator-wrapper">
        <aside id="sidebar">
            <div class="sidebar-header">
                <img src="logo.png" alt="Ray2Volt Solar Logo" class="sidebar-logo mb-0">
                <p class="text-sm opacity-75">Solar Investment Calculator</p>
                <p class="text-sm opacity-75">
                    Interested in going solar with us?
                    <a href="https://ray2voltsolar.com" target="_blank" class="text-blue-500 hover:underline">Visit our
                        website!</a>
                </p>
            </div>

            <form id="solarForm" class="input-form" onsubmit="return false;">
                <h2 class="font-bold">Project & Finance</h2>

                <div class="input-group">
                    <label for="kwInstalled" class="font-bold text-lg">Solar System Capacity:</label>
                    <select id="kwInstalled" onchange="calculateSavings()" class="text-lg">
                        <option value="" disabled selected>Select kW Capacity</option>
                        <option value="2">2 kW</option>
                        <option value="3">3 kW</option>
                        <option value="4">4 kW</option>
                        <option value="5">5 kW</option>
                        <option value="6">6 kW</option>
                        <option value="7">7 kW</option>
                        <option value="8">8 kW</option>
                        <option value="9">9 kW</option>
                        <option value="10">10 kW</option>
                        <option value="manual">Manual Entry</option>
                    </select>
                </div>
                <div class="input-group" id="manualKwInputGroup" style="display: none;">
                    <label for="manualKwInput" class="font-bold text-lg">Manual System Capacity (kW):</label>
                    <input type="number" id="manualKwInput" placeholder="Enter kW (e.g., 12)" class="text-lg" step="0.1"
                        oninput="calculateSavings()">
                </div>

                <div class="input-group">
                    <label for="totalCost" class="font-bold text-lg">Total Project Cost (₹):</label>
                    <input type="number" id="totalCost" placeholder="Enter project cost" class="text-lg">
                    <small>Auto-filled for 2-10 kW, editable. Enter manually for other capacities.</small>
                </div>

                <div class="input-group">
                    <label for="subsidyAmount" class="font-bold text-lg">Subsidy Amount (₹):</label>
                    <input type="number" id="subsidyAmount" step="100" required placeholder="e.g., 40000" value="0"
                        class="text-lg">
                </div>

                <div class="input-group">
                    <label for="downPayment" class="font-bold text-lg">Down Payment (₹):</label>
                    <input type="number" id="downPayment" step="100" required placeholder="e.g., 50000" class="text-lg">
                </div>

                <div class="input-group">
                    <label for="loanTenure" class="font-bold text-lg">Loan Tenure (Years):</label>
                    <input type="number" id="loanTenure" step="1" required placeholder="e.g., 5" class="text-lg">
                </div>

                <div class="input-group">
                    <label for="interestRate" class="font-bold text-lg">Annual Interest Rate (%):</label>
                    <input type="number" id="interestRate" step="0.1" required placeholder="e.g., 9.5" class="text-lg">
                </div>

                <h2 class="font-bold">Energy Consumption</h2>

                <div class="input-group">
                    <label for="unitsPerKwDay" class="font-bold text-lg">Daily Units / kW (kWh):</label>
                    <input type="number" id="unitsPerKwDay" step="0.1" required placeholder="e.g., 4.5" value="4.5"
                        class="text-lg">
                </div>

                <div class="input-group">
                    <label for="avgUnitsConsumed" class="font-bold text-lg">Monthly Consumption (kWh):</label>
                    <input type="number" id="avgUnitsConsumed" step="1" required placeholder="e.g., 400"
                        class="text-lg">
                </div>

                <div class="input-group">
                    <label for="costPerUnit" class="font-bold text-lg">Grid Cost / Unit (₹/kWh):</label>
                    <input type="number" id="costPerUnit" step="0.01" required placeholder="e.g., 7.50" class="text-lg">
                </div>

                <div class="input-group">
                    <label for="additionalCharges" class="font-bold text-lg">Additional Charges (₹/month):</label>
                    <input type="number" id="additionalCharges" step="0.01" required placeholder="e.g., 100" value="0"
                        class="text-lg">
                </div>

                <div class="input-group">
                    <label for="inflationRate" class="font-bold text-lg">Electricity Inflation (%):</label>
                    <input type="number" id="inflationRate" step="0.1" required placeholder="e.g., 4.0" value="4.0"
                        class="text-lg">
                </div>

                <div class="input-group">
                    <label for="netMeteringRate" class="font-bold text-lg">Export Rate (₹/kWh):</label>
                    <input type="number" id="netMeteringRate" step="0.01" required placeholder="e.g., 3.50"
                        class="text-lg">
                </div>

                <button type="button" onclick="calculateSavings()" class="calculate-btn font-bold">Calculate
                    Savings</button>
                <div id="errorMessage" class="error-message" style="display: none;"></div>
            </form>
        </aside>

        <main id="main-content">
            <div id="initialMessage">
                <h2 class="font-bold">Welcome to Solar Savings Calculator</h2>
                <p>Enter your details in the sidebar to calculate your potential solar savings.</p>
            </div>

            <div id="resultsSection" class="results-section" style="display: none;">
                <h2 class="font-bold">Solar Investment Analysis</h2>

                <!-- Main Results Table -->
                <div class="data-table-wrapper">
                    <table id="resultsTable" class="data-table">
                        <thead>
                            <tr>
                                <th class="metric-col font-bold">Metric</th>
                                <th class="font-bold">Value</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Populated by JS -->
                        </tbody>
                    </table>
                </div>

                <!-- Monthly Costs Comparison Table (Year 1 Average Snapshot) -->
                <h3 class="font-bold">Monthly Costs Comparison (Year 1 Average)</h3>
                <div id="monthlyCostsComparison" class="data-table-wrapper">
                    <!-- Table generated by JS -->
                </div>

                <!-- Breakeven Analysis Table (Accounts for Inflation & Rollover) -->
                <h3 class="font-bold">Breakeven Analysis (Year-by-Year)</h3>
                <div id="breakevenAnalysis" class="data-table-wrapper">
                    <!-- Table generated by JS -->
                </div>

                <!-- Report/Print Button -->
                <div class="report-btn-wrapper">
                    <button onclick="openReportModal()" class="report-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                            <line x1="16" y1="13" x2="8" y2="13"></line>
                            <line x1="16" y1="17" x2="8" y2="17"></line>
                            <polyline points="10 9 9 9 8 9"></polyline>
                        </svg>
                        View Detailed Report & Print
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"
                            class="report-btn-arrow">
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                            <polyline points="12 5 19 12 12 19"></polyline>
                        </svg>
                    </button>
                </div>

            </div> <!-- End Results Section -->
        </main> <!-- End Main Content -->
    </div> <!-- End Calculator Wrapper -->

    <!-- Report Preview Modal -->
    <div id="reportModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Solar Savings Report Preview</h3>
                <div class="modal-header-actions">
                    <button class="btn-primary" onclick="printReport()">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="6 9 6 2 18 2 18 9"></polyline>
                            <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2">
                            </path>
                            <rect x="6" y="14" width="12" height="8"></rect>
                        </svg>
                        Print / Save PDF
                    </button>
                    <button class="close-modal-btn" onclick="closeReportModal()">&times;</button>
                </div>
            </div>
            <div class="modal-body" id="modalBody">

                <!-- ===== PAGE 1 ===== -->
                <div class="report-page" id="printableReport">
                    <div class="report-page-header">
                        <div class="report-page-title-block">
                            <h1>Solar Savings Analysis</h1>
                            <p class="report-tagline">Personalized Financial & Energy Projection</p>
                            <p class="report-date" id="reportDate"></p>
                        </div>
                        <img src="logo.png" alt="Ray2Volt Solar" class="report-page-logo">
                    </div>
                    <div class="report-accent-bar"></div>

                    <div class="report-section">
                        <h4>
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                <line x1="3" y1="9" x2="21" y2="9"></line>
                                <line x1="9" y1="21" x2="9" y2="9"></line>
                            </svg>
                            Requirements Summary
                        </h4>
                        <div class="req-summary-grid" id="reqSummaryGrid">
                            <!-- Populated by JS -->
                        </div>
                    </div>

                    <div class="report-section">
                        <h4>
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <line x1="12" y1="1" x2="12" y2="23"></line>
                                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                            </svg>
                            Financial Overview
                        </h4>
                        <div class="report-table-container" id="reportFinancialTable">
                            <!-- Populated by JS -->
                        </div>
                    </div>

                    <div class="report-section">
                        <h4>
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect>
                                <line x1="1" y1="10" x2="23" y2="10"></line>
                            </svg>
                            Monthly Costs Comparison
                        </h4>
                        <div class="report-table-container" id="reportMonthlyTable">
                            <!-- Populated by JS -->
                        </div>
                    </div>

                    <div class="report-page-footer">
                        <span>Generated by Ray2Volt Solar</span>
                        <span>ray2voltsolar.com</span>
                        <span>Page 1</span>
                    </div>
                </div>

                <!-- ===== PAGE 2 ===== -->
                <div class="report-page" id="printableReport2">
                    <div class="report-page-header report-page-header--compact">
                        <div class="report-page-title-block">
                            <h2>Solar Savings Analysis</h2>
                            <p class="report-tagline">Long-Term Projection</p>
                        </div>
                        <img src="logo.png" alt="Ray2Volt Solar" class="report-page-logo report-page-logo--small">
                    </div>
                    <div class="report-accent-bar"></div>

                    <div class="report-section report-section--full">
                        <h4>
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                            </svg>
                            Long-Term Breakeven Analysis (25-Year Projection)
                        </h4>
                        <p class="report-note">*Projected cash flows accounting for inflation and utility rate
                            increases.</p>
                        <div class="report-table-container" id="reportBreakevenTable">
                            <!-- Populated by JS -->
                        </div>
                    </div>

                    <div class="report-disclaimer">
                        <p><strong>Disclaimer:</strong> This report is an estimate based on the inputs provided and
                            standard assumptions. Actual savings may vary based on weather conditions, electricity
                            tariff changes, system performance, and other factors. This is not a guarantee of
                            savings.</p>
                    </div>

                    <div class="report-page-footer">
                        <span>Generated by Ray2Volt Solar</span>
                        <span>ray2voltsolar.com</span>
                        <span>Page 2</span>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        MathJax = {
            tex: {
                inlineMath: [['\\(', '\\)'], ['$', '$']],
                displayMath: [['\\[', '\\]']]
            },
            svg: {
                fontCache: 'global'
            }
        };
    </script>
    <script type="text/javascript" id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
        </script>
</body>

</html>